
[xUnit.net 00:00:00.18]     backend.Application.UnitTests.Members.Commands.UpdateMember.UpdateMemberCommandHandlerTests.Handle_ShouldThrowNotFoundException_WhenMemberNotFound [FAIL]
[xUnit.net 00:00:00.20]     backend.Application.UnitTests.Members.Commands.UpdateMember.UpdateMemberCommandHandlerTests.Handle_ShouldUpdateIsRootCorrectly_WhenNewRootIsSet [FAIL]
[xUnit.net 00:00:00.20]     backend.Application.UnitTests.Members.Commands.UpdateMember.UpdateMemberCommandHandlerTests.Handle_ShouldUpdateMemberAndReturnSuccessResult_WhenMemberExistsAndAuthorized [FAIL]
  Failed backend.Application.UnitTests.Members.Commands.UpdateMember.UpdateMemberCommandHandlerTests.Handle_ShouldThrowNotFoundException_WhenMemberNotFound [55 ms]
  Error Message:
   Expected a <backend.Application.Common.Exceptions.NotFoundException> to be thrown, but found <System.InvalidOperationException>:
System.InvalidOperationException: The provider for the source 'IQueryable' doesn't implement 'IAsyncQueryProvider'. Only providers that implement 'IAsyncQueryProvider' can be used for Entity Framework asynchronous operations.
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, LambdaExpression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.FirstOrDefaultAsync[TSource](IQueryable`1 source, Expression`1 predicate, CancellationToken cancellationToken)
   at backend.Application.Members.Commands.UpdateMember.UpdateMemberCommandHandler.Handle(UpdateMemberCommand request, CancellationToken cancellationToken) in /Users/kimthaohuynh/Documents/Projects/family-tree-3/src/backend/src/Application/Member/Commands/UpdateMember/UpdateMemberCommandHandler.cs:line 39
   at FluentAssertions.Specialized.AsyncFunctionAssertions`2.InvokeWithInterceptionAsync(Func`1 action).
  Stack Trace:
     at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Specialized.DelegateAssertionsBase`2.ThrowInternal[TException](Exception exception, String because, Object[] becauseArgs)
   at FluentAssertions.Specialized.AsyncFunctionAssertions`2.ThrowAsync[TException](String because, Object[] becauseArgs)
   at FluentAssertions.ExceptionAssertionsExtensions.WithMessage[TException](Task`1 task, String expectedWildcardPattern, String because, Object[] becauseArgs)
   at backend.Application.UnitTests.Members.Commands.UpdateMember.UpdateMemberCommandHandlerTests.Handle_ShouldThrowNotFoundException_WhenMemberNotFound() in /Users/kimthaohuynh/Documents/Projects/family-tree-3/src/backend/tests/Application.UnitTests/Member/Commands/UpdateMember/UpdateMemberCommandHandlerTests.cs:line 144
--- End of stack trace from previous location ---
  Failed backend.Application.UnitTests.Members.Commands.UpdateMember.UpdateMemberCommandHandlerTests.Handle_ShouldUpdateIsRootCorrectly_WhenNewRootIsSet [13 ms]
  Error Message:
   System.NotSupportedException : Unsupported expression: ... => ....FirstOrDefaultAsync<Member>(m => m.Id == command.Id, It.IsAny<CancellationToken>())
Extension methods (here: EntityFrameworkQueryableExtensions.FirstOrDefaultAsync) may not be used in setup / verification expressions.
  Stack Trace:
     at Moq.Guard.IsOverridable(MethodInfo method, Expression expression) in /_/src/Moq/Guard.cs:line 87
   at Moq.MethodExpectation..ctor(LambdaExpression expression, MethodInfo method, IReadOnlyList`1 arguments, Boolean exactGenericTypeArguments, Boolean skipMatcherInitialization, Boolean allowNonOverridable) in /_/src/Moq/MethodExpectation.cs:line 236
   at Moq.ExpressionExtensions.<Split>g__Split|5_0(Expression e, Expression& r, MethodExpectation& p, Boolean assignment, Boolean allowNonOverridableLastProperty) in /_/src/Moq/ExpressionExtensions.cs:line 256
   at Moq.ExpressionExtensions.Split(LambdaExpression expression, Boolean allowNonOverridableLastProperty) in /_/src/Moq/ExpressionExtensions.cs:line 170
   at Moq.Mock.SetupRecursive[TSetup](Mock mock, LambdaExpression expression, Func`4 setupLast, Boolean allowNonOverridableLastProperty) in /_/src/Moq/Mock.cs:line 728
   at Moq.Mock.Setup(Mock mock, LambdaExpression expression, Condition condition) in /_/src/Moq/Mock.cs:line 562
   at Moq.Mock`1.Setup[TResult](Expression`1 expression) in /_/src/Moq/Mock`1.cs:line 645
   at backend.Application.UnitTests.Members.Commands.UpdateMember.UpdateMemberCommandHandlerTests.Handle_ShouldUpdateIsRootCorrectly_WhenNewRootIsSet() in /Users/kimthaohuynh/Documents/Projects/family-tree-3/src/backend/tests/Application.UnitTests/Member/Commands/UpdateMember/UpdateMemberCommandHandlerTests.cs:line 276
--- End of stack trace from previous location ---
  Failed backend.Application.UnitTests.Members.Commands.UpdateMember.UpdateMemberCommandHandlerTests.Handle_ShouldUpdateMemberAndReturnSuccessResult_WhenMemberExistsAndAuthorized [5 ms]
  Error Message:
   System.NotSupportedException : Unsupported expression: ... => ....FirstOrDefaultAsync<Member>(It.IsAny<Expression<Func<Member, bool>>>(), It.IsAny<CancellationToken>())
Extension methods (here: EntityFrameworkQueryableExtensions.FirstOrDefaultAsync) may not be used in setup / verification expressions.
  Stack Trace:
     at Moq.Guard.IsOverridable(MethodInfo method, Expression expression) in /_/src/Moq/Guard.cs:line 87
   at Moq.MethodExpectation..ctor(LambdaExpression expression, MethodInfo method, IReadOnlyList`1 arguments, Boolean exactGenericTypeArguments, Boolean skipMatcherInitialization, Boolean allowNonOverridable) in /_/src/Moq/MethodExpectation.cs:line 236
   at Moq.ExpressionExtensions.<Split>g__Split|5_0(Expression e, Expression& r, MethodExpectation& p, Boolean assignment, Boolean allowNonOverridableLastProperty) in /_/src/Moq/ExpressionExtensions.cs:line 256
   at Moq.ExpressionExtensions.Split(LambdaExpression expression, Boolean allowNonOverridableLastProperty) in /_/src/Moq/ExpressionExtensions.cs:line 170
   at Moq.Mock.SetupRecursive[TSetup](Mock mock, LambdaExpression expression, Func`4 setupLast, Boolean allowNonOverridableLastProperty) in /_/src/Moq/Mock.cs:line 728
   at Moq.Mock.Setup(Mock mock, LambdaExpression expression, Condition condition) in /_/src/Moq/Mock.cs:line 562
   at Moq.Mock`1.Setup[TResult](Expression`1 expression) in /_/src/Moq/Mock`1.cs:line 645
   at backend.Application.UnitTests.Members.Commands.UpdateMember.UpdateMemberCommandHandlerTests.Handle_ShouldUpdateMemberAndReturnSuccessResult_WhenMemberExistsAndAuthorized() in /Users/kimthaohuynh/Documents/Projects/family-tree-3/src/backend/tests/Application.UnitTests/Member/Commands/UpdateMember/UpdateMemberCommandHandlerTests.cs:line 187
--- End of stack trace from previous location ---

Failed!  - Failed:     3, Passed:     2, Skipped:     0, Total:     5, Duration: 79 ms - Application.UnitTests.dll (net8.0)